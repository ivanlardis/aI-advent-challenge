# üß™ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —Ñ–∏–ª—å—Ç—Ä–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ RAG

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
–î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `.env`:
```env
RAG_MIN_SCORE=0.7          # –ü–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ (0.0-1.0)
RAG_FILTER_ENABLED=true    # –í–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
RAG_TOP_K=3                # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
```

### 2. **–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π**
–§–∞–π–ª: `app/rag/rag_service.py:80-146`

–ú–µ—Ç–æ–¥ `search()` —Ç–µ–ø–µ—Ä—å:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `min_score` –∏ `apply_filter`
- –§–∏–ª—å—Ç—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –ø–æ—Ä–æ–≥—É
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### 3. **UI —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**
–§–∞–π–ª: `app/chat/chainlit_app.py`

**–ö–Ω–æ–ø–∫–∏:**
- üîç –í–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
- üîì –í—ã–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä

**–ö–æ–º–∞–Ω–¥—ã:**
- `/filter on` - –≤–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
- `/filter off` - –≤—ã–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
- `/filter set 0.75` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Ä–æ–≥ 0.75

### 4. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**
–§—É–Ω–∫—Ü–∏—è `display_rag_results()` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- ‚úÖ –ü—Ä–∏–Ω—è—Ç—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (score >= –ø–æ—Ä–æ–≥–∞)
- ‚ùå –û—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (score < –ø–æ—Ä–æ–≥–∞)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

---

## üöÄ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã (–±—ã—Å—Ç—Ä–æ)

```bash
python3 test_filter_logic.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –í–°–ï 4 –¢–ï–°–¢–ê –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û!

–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
  ‚úì –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ—Ä–æ–≥—É —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
  ‚úì –í—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥ (0.9) –æ—Ç—Å–µ–∫–∞–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  ‚úì –ù–∏–∑–∫–∏–π –ø–æ—Ä–æ–≥ (0.5) –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø–æ—á—Ç–∏ –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
  ‚úì –ì—Ä–∞–Ω–∏—á–Ω—ã–π —Å–ª—É—á–∞–π (–≤—Å–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ UI

#### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```bash
# –ï—Å–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ
docker-compose up -d

# –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
open http://localhost:8000
```

#### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
–í –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
‚Ä¢ RAG: ‚úÖ –í–ö–õ–Æ–ß–ï–ù
‚Ä¢ –§–∏–ª—å—Ç—Ä —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏: ‚úÖ (–ø–æ—Ä–æ–≥: 0.70)

–ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
‚Ä¢ /rag on|off
‚Ä¢ /filter on|off
‚Ä¢ /filter set 0.75
```

#### –®–∞–≥ 3: –¢–µ—Å—Ç —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –í–ö–õ–Æ–ß–ï–ù
1. –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å: **"–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –¢–≤–µ—Ä—å"**
2. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
[RAG] –ù–∞–π–¥–µ–Ω–æ 3 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –ø—Ä–æ—à–ª–æ —Ñ–∏–ª—å—Ç—Ä: 1 (–ø–æ—Ä–æ–≥: 0.70)

‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ (–Ω–∏–∑–∫–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å):
- –¢—É–ª–∞ (score: 0.650 < 0.70)
- –ë—Ä—è–Ω—Å–∫ (score: 0.620 < 0.70)

‚úÖ –ü—Ä–∏–Ω—è—Ç–æ:
1. –¢–≤–µ—Ä—å (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: 0.950)
   –°–∞–º—ã–π –ª—É—á—à–∏–π –≥–æ—Ä–æ–¥ –Ω–∞ –∑–µ–º–ª–µ...
```

#### –®–∞–≥ 4: –¢–µ—Å—Ç —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –í–´–ö–õ–Æ–ß–ï–ù
1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üîì –í—ã–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä"** –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ `/filter off`
2. –ó–∞–¥–∞–π—Ç–µ —Ç–æ—Ç –∂–µ –≤–æ–ø—Ä–æ—Å: **"–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –¢–≤–µ—Ä—å"**
3. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
[RAG] –ù–∞–π–¥–µ–Ω–æ 3 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

‚úÖ –ü—Ä–∏–Ω—è—Ç–æ:
1. –¢–≤–µ—Ä—å (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: 0.950)
2. –¢—É–ª–∞ (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: 0.650)
3. –ë—Ä—è–Ω—Å–∫ (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: 0.620)
```

#### –®–∞–≥ 5: –¢–µ—Å—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä–æ–≥–∞
1. –í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É: `/filter set 0.9`
2. –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è: **"üîç –ü–æ—Ä–æ–≥ —Ñ–∏–ª—å—Ç—Ä–∞ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ 0.90"**
3. –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å —Å–Ω–æ–≤–∞
4. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç - —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å score >= 0.9

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞

### –ë–ï–ó —Ñ–∏–ª—å—Ç—Ä–∞ (–ø–æ—Ä–æ–≥: –Ω–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–≥–æ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
1. –¢–≤–µ—Ä—å (0.950) ‚úÖ - —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ
2. –¢—É–ª–∞ (0.650) ‚ùå - –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ (–ø–æ—Ö–æ–∂–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)
3. –ë—Ä—è–Ω—Å–∫ (0.620) ‚ùå - –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ (—à–∞–±–ª–æ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç)

–û—Ç–≤–µ—Ç LLM: –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```

### –° —Ñ–∏–ª—å—Ç—Ä–æ–º (–ø–æ—Ä–æ–≥: 0.7)
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –¢–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
```
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
1. –¢–≤–µ—Ä—å (0.950) ‚úÖ - —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ

–û—Ç–≤–µ—Ç LLM: —Ç–æ—á–Ω—ã–π, –æ—Å–Ω–æ–≤–∞–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏

| –ü–æ—Ä–æ–≥ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-------|-----------|-----------|
| **0.5** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ–ª–Ω–æ—Ç–∞ | –ú–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –≤–æ–∑–º–æ–∂–µ–Ω —à—É–º |
| **0.7** | **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å** | –¢–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –º–∏–Ω–∏–º—É–º —à—É–º–∞ |
| **0.9** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å | –¢–æ–ª—å–∫–æ –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã |

---

## üîç –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

1. **"–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –¢–≤–µ—Ä—å"**
   - –° —Ñ–∏–ª—å—Ç—Ä–æ–º 0.7: 1-2 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
   - –ë–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞: 3+ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

2. **"–ß—Ç–æ —Ç—ã –∑–Ω–∞–µ—à—å –æ –ú–æ—Å–∫–≤–µ?"**
   - –í—ã—Å–æ–∫–∏–π score (–≤–µ—Ä–æ—è—Ç–Ω–æ 0.9+)
   - –î–∞–∂–µ —Å –≤—ã—Å–æ–∫–∏–º –ø–æ—Ä–æ–≥–æ–º –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

3. **"–ì–æ—Ä–æ–¥–∞ –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–≥–µ"**
   - –ú–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ scores
   - –•–æ—Ä–æ—à–∏–π —Ç–µ—Å—Ç –¥–ª—è –ø–æ—Ä–æ–≥–∞ 0.7

4. **"–ó–µ–ª–µ–Ω–æ–≥—Ä–∞–¥"**
   - –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–∞ —Ä–µ–¥–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

---

## ‚ö†Ô∏è –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

### –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã
**–ó–∞–ø—Ä–æ—Å:** "–ì–æ—Ä–æ–¥ XYZ" (–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
```
‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—ã—à–µ –ø–æ—Ä–æ–≥–∞ 0.70,
–ø–æ–∫–∞–∑—ã–≤–∞—é –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (score: 0.45)
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –õ—É—á—à–µ –ø–æ–∫–∞–∑–∞—Ç—å —Ö–æ—Ç—å —á—Ç–æ-—Ç–æ, —á–µ–º –Ω–∏—á–µ–≥–æ.

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:

```python
# –í app/rag/rag_service.py
logger.info(f"RAG Query: '{query[:50]}' | k={k} | min_score={min_score} | filter={apply_filter}")
logger.info(f"Filtering: {len(all_results)} ‚Üí {len(filtered_results)} results | rejected={len(rejected)}")
logger.debug(f"Rejected: {r['city']} (score={r['score']:.3f} < {min_score})")
```

**–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:**
```bash
docker-compose logs app -f | grep "RAG"
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- [x] –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –§–∏–ª—å—Ç—Ä –≤–∫–ª—é—á–∞–µ—Ç—Å—è/–≤—ã–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ UI
- [ ] –ü–æ—Ä–æ–≥ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `/filter set`
- [ ] –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –æ—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –ø—Ä–∏—á–∏–Ω–æ–π
- [ ] –ì—Ä–∞–Ω–∏—á–Ω—ã–π —Å–ª—É—á–∞–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ö–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤ LLM —É–ª—É—á—à–∏–ª–æ—Å—å —Å —Ñ–∏–ª—å—Ç—Ä–æ–º

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –§–∏–ª—å—Ç—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env`:
```bash
grep RAG_ .env
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# RAG_MIN_SCORE=0.7
# RAG_FILTER_ENABLED=true
# RAG_TOP_K=3
```

### –ü—Ä–æ–±–ª–µ–º–∞: –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –°–Ω–∏–∑—å—Ç–µ –ø–æ—Ä–æ–≥ —á–µ—Ä–µ–∑ `/filter set 0.5`

### –ü—Ä–æ–±–ª–µ–º–∞: RAG –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:**
```bash
docker-compose logs app | grep RAG
docker-compose restart app
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### –ß—Ç–æ —Ç–∞–∫–æ–µ reranker?
Reranker - —ç—Ç–æ –≤—Ç–æ—Ä–æ–π —ç—Ç–∞–ø —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞. –í–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–æ—Ä–æ–≥–∞ –ø–æ similarity score –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å (cross-encoder) –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏.

**–ù–∞—à –ø–æ–¥—Ö–æ–¥ (–ø—Ä–æ—Å—Ç–æ–π –ø–æ—Ä–æ–≥):**
- ‚úÖ –ë—ã—Å—Ç—Ä–æ
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- ‚úÖ –ü–æ–Ω—è—Ç–Ω–æ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ
- ‚ö†Ô∏è –ú–µ–Ω–µ–µ —Ç–æ—á–Ω–æ, —á–µ–º cross-encoder

**Cross-encoder reranker:**
- ‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–µ–µ
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏ (~500 –ú–ë)
- ‚úÖ –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π
- ‚úÖ –£—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –ø–æ–¥—Ö–æ–¥?

**–ü—Ä–æ—Å—Ç–æ–π –ø–æ—Ä–æ–≥ (—Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è):**
- –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã
- –ù–µ–±–æ–ª—å—à–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π (<10K –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
- –ß–µ—Ç–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**Cross-encoder:**
- –ö—Ä–∏—Ç–∏—á–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å
- –ë–æ–ª—å—à–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π (>100K –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
- –°–ª–æ–∂–Ω—ã–µ, –º–Ω–æ–≥–æ–∑–Ω–∞—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

---

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** üöÄ
